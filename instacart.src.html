

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>instacart.src package &mdash; Mark Weiss 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Mark Weiss 0.0.1 documentation" href="index.html"/>
        <link rel="up" title="instacart package" href="instacart.html"/>
        <link rel="next" title="batch_manager package" href="batch_manager.html"/>
        <link rel="prev" title="instacart package" href="instacart.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Mark Weiss
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="instacartSummary.html">PREDICTING SHOPPER TIME</a></li>
<li class="toctree-l1"><a class="reference internal" href="BatchManager.html">BATCH MANAGER</a></li>
<li class="toctree-l1"><a class="reference internal" href="slides.html">ROUTE VISION</a></li>
<li class="toctree-l1"><a class="reference internal" href="UserAdoption.html">USER ADOPTION</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">code</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="instacart.html">instacart package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="instacart.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">instacart.src package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="instacart.html#module-instacart">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="batch_manager.html">batch_manager package</a></li>
<li class="toctree-l2"><a class="reference internal" href="route_vision.html">route_vision package</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_adoption.html">user_adoption package</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html">network_analysis package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wikitravel.html">wikitravel package</a></li>
<li class="toctree-l2"><a class="reference internal" href="cvcparser.html">cvcparser package</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesync.html">filesync package</a></li>
<li class="toctree-l2"><a class="reference internal" href="classic.html">classic package</a></li>
<li class="toctree-l2"><a class="reference internal" href="helpers.html">helpers package</a></li>
<li class="toctree-l2"><a class="reference internal" href="quadtree.html">quadtree package</a></li>
<li class="toctree-l2"><a class="reference internal" href="sirdisease.html">sirdisease package</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Mark Weiss</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="modules.html">code</a> &raquo;</li>
      
          <li><a href="instacart.html">instacart package</a> &raquo;</li>
      
    <li>instacart.src package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/instacart.src.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="instacart-src-package">
<h1>instacart.src package<a class="headerlink" href="#instacart-src-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-instacart.src.modelowner">
<span id="instacart-src-modelowner-module"></span><h2>instacart.src.modelowner module<a class="headerlink" href="#module-instacart.src.modelowner" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="instacart.src.modelowner.Features">
<em class="property">class </em><code class="descclassname">instacart.src.modelowner.</code><code class="descname">Features</code><span class="sig-paren">(</span><em>orderPath</em>, <em>tripsPath</em>, <em>columns</em>, <em>dumCols=()</em>, <em>trainSet=True</em>, <em>templateDf=None</em>, <em>percent=0.1</em>, <em>tt_split=None</em>, <em>split=False</em>, <em>test=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/modelowner.html#Features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.modelowner.Features" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Class for cleaning and transforming order and trip data for modeling. Generates design and test <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.19.2)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a> attributes for modeling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>orderPath</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to orders csv</li>
<li><strong>tripsPath</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to trips csv</li>
<li><strong>dumCols</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) &#8211; columns to dummify</li>
<li><strong>trainSet</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; switch for operating on training data (with target)</li>
<li><strong>templateDf</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.19.2)"><em>pandas.DataFrame</em></a>) &#8211; template from data frame from training to prescribe format of test data</li>
<li><strong>percent</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; percent threshold for margnial distribution (department_name) transformation</li>
<li><strong>tt_split</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; keyword arguments for train test split</li>
<li><strong>split</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; switch for train test split</li>
<li><strong>test</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; switch for test data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="instacart.src.modelowner.Features.train_test_split">
<code class="descname">train_test_split</code><span class="sig-paren">(</span><em>kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/modelowner.html#Features.train_test_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.modelowner.Features.train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>train test split on data from sklearn</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; keyword arguments for train test split</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="instacart.src.modelowner.Features.build_dummies">
<code class="descname">build_dummies</code><span class="sig-paren">(</span><em>cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/modelowner.html#Features.build_dummies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.modelowner.Features.build_dummies" title="Permalink to this definition">¶</a></dt>
<dd><p>Dummify prescribed columns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) &#8211; columns to dummify</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="instacart.src.modelowner.Features.convert_time">
<code class="descname">convert_time</code><span class="sig-paren">(</span><em>trainSet</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/modelowner.html#Features.convert_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.modelowner.Features.convert_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert start (end if applicable) timestamps to seconds. Builds day of week, hour of day features                and target (dt in seconds)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trainSet</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; switch for train set to build target</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="instacart.src.modelowner.Features.create_trips">
<code class="descname">create_trips</code><span class="sig-paren">(</span><em>columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/modelowner.html#Features.create_trips"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.modelowner.Features.create_trips" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter trips table columns for design matrix
Aggregate orders table data (sum(quantity) and len(unique(department names) for trip)                and join to design matrix (keyed off trip id)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>columns</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; columns to include from trips data in design</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="instacart.src.modelowner.grid_search">
<code class="descclassname">instacart.src.modelowner.</code><code class="descname">grid_search</code><span class="sig-paren">(</span><em>data, estimator=RandomForestRegressor(bootstrap=True, criterion='mse', max_depth=None,            max_features='auto', max_leaf_nodes=None,            min_impurity_split=1e-07, min_samples_leaf=1,            min_samples_split=2, min_weight_fraction_leaf=0.0,            n_estimators=40, n_jobs=1, oob_score=False, random_state=None,            verbose=0, warm_start=False), param_grid={'min_samples_split': [40, 50, 60], 'max_features': ['auto', 'sqrt', 'log2'], 'max_depth': [40, 50, 60]}, cv=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/modelowner.html#grid_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.modelowner.grid_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a model of type estimator with paramters prescribed by cross validated grid search. After cross validation, best estimator is built
on parameter combination and trained on entire training set. Returns both production ready model and grid search object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference internal" href="#instacart.src.modelowner.Features" title="instacart.src.modelowner.Features"><em>Features</em></a>) &#8211; data object, requires design, target, and designTest targetTest attributes <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.19.2)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a></li>
<li><strong>estimator</strong> (<em>classifier/estimator</em>) &#8211; base estimator to grid search <code class="xref py py-class docutils literal"><span class="pre">sklearn.GridSearchCV</span></code></li>
<li><strong>param_grid</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; paramter grid to search in grid search</li>
<li><strong>cv</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; number of folds for cross validation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">model grid data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple.(estimator, GridSearchCV, Features)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="instacart.src.modelowner.main">
<code class="descclassname">instacart.src.modelowner.</code><code class="descname">main</code><span class="sig-paren">(</span><em>model=None</em>, <em>grid=None</em>, <em>grid_kwargs=None</em>, <em>data=None</em>, <em>template=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/modelowner.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.modelowner.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function for training model to create predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>classifier/estimator</em>) &#8211; base estimator to grid search <code class="xref py py-class docutils literal"><span class="pre">sklearn.GridSearchCV</span></code></li>
<li><strong>grid</strong> (<em>sklearn.GridSearchCV</em>) &#8211; grid searched object</li>
<li><strong>grid_kwargs</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; keyword arguments for <code class="xref py py-class docutils literal"><span class="pre">sklearn.GridSearchCV</span></code></li>
<li><strong>data</strong> (<a class="reference internal" href="#instacart.src.modelowner.Features" title="instacart.src.modelowner.Features"><em>Features</em></a>) &#8211; data object, requires design, target, and designTest targetTest attributes <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.19.2)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a></li>
<li><strong>template</strong> (<a class="reference internal" href="#instacart.src.modelowner.Features" title="instacart.src.modelowner.Features"><em>Features</em></a>) &#8211; train object template to create test design</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">model grid</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple.(estimator, GridSearchCV)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-instacart.src.helper">
<span id="instacart-src-helper-module"></span><h2>instacart.src.helper module<a class="headerlink" href="#module-instacart.src.helper" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="instacart.src.helper.df_table">
<code class="descclassname">instacart.src.helper.</code><code class="descname">df_table</code><span class="sig-paren">(</span><em>df</em>, <em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/instacart/src/helper.html#df_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#instacart.src.helper.df_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to create rst tables from <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.19.2)"><code class="xref py py-class docutils literal"><span class="pre">pandas.DataFrame</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.19.2)"><em>pandas.DataFrame</em></a>) &#8211; data frame</li>
<li><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; string file name</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-instacart.src">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-instacart.src" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="batch_manager.html" class="btn btn-neutral float-right" title="batch_manager package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="instacart.html" class="btn btn-neutral" title="instacart package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Mark Weiss.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>